\documentclass{beamer}
\usetheme{Copenhagen}

\title{Learning with Errors and GSW's Homomorphic Encryption}

\begin{document}

\frame{
	\titlepage
}

\frame{
	\frametitle{Intuition of LWE}
	$$14s_1+15s_2+5s_3+2s_4\approx8\pmod{17}$$
	$$13s_1+14s_2+14s_3+6s_4\approx16\pmod{17}$$
	$$6s_1+10s_2+13s_3+s_4\approx3\pmod{17}$$
	$$10s_1+4s_2+12s_3+16s_4\approx12\pmod{17}$$
	$$9s_1+5s_2+9s_3+6s_4\approx9\pmod{17}$$
	$$3s_1+6s_2+4s_3+5s_4\approx16\pmod{17}$$
	$$\vdots$$
	$$6s_1+7s_2+16s_3+2s_4\approx3\pmod{17}$$
}

\frame{
	\frametitle{Definition (LWE Problem)}
	\begin{itemize}[<+->]
		\item Pick uniformly random $\vec{s}\in\mathbb{Z}^n_q$
		\item Take $\chi$ to be a discrete Gaussian distribution with some
			variance to be specified
		\item Input: $poly(n)$ equations sampled as below:
			\begin{itemize}[<+->]
				\item pick coefficients $\vec{a}\in\mathbb{Z}^n_q$ at random
				\item Sample error $e\leftarrow\chi$
				\item Output $(\vec{a}\cdot\vec{s} + e,
					\vec{a})\in\mathbb{Z}^{1+n}_q$
			\end{itemize}
		\item Output: $\vec{s}$
		\item Note that $(\vec{a}\cdot\vec{s} + e, \vec{a})
			\cdot(1,-\vec{s}) = e$
	\end{itemize}
}

\frame{
	\frametitle{Homomorphic encryption}
	Allows secure communication by using the tools below:
	\pause
	\begin{itemize}[<+->]
		\item $pk$: ``public key", used for encryption
		\item $\textnormal{Enc}_{pk}:\Sigma^*\times\mathcal{R}\rightarrow U$
		\item $sk$: ``secret key", used for decryption
		\item $\textnormal{Dec}_{sk}:U\rightarrow\Sigma^*$.
		\item $evk$: ``evaluation key"
	\end{itemize}
}

\frame{
	\frametitle{Idea of GSW's homomorphic encryption}
	Intuitive idea as follows:
	\begin{itemize}[<+->]
		\item private key $\vec{v}$ is a vector
		\item ciphertexts are matrices with $\vec{v}$ approximately as an
			eigenvector
		\item plaintexts are corresponding approximate eigenvalues
		\item $(C_1+C_2)\vec{v}\approx(\lambda_1+\lambda_2)\vec{v}$
		\item $(C_1C_2)\vec{v}\approx(\lambda_1\lambda_2)\vec{v}$
		\item When plaintexts are booleans, $I_N-C_1C_2$ encodes NAND.
	\end{itemize}
}

\frame{
	\frametitle{Idea of GSW's homomorphic encryption cont.}
	\begin{itemize}[<+->]
		\item Take $pk$ to be a matrix where each row is a tuple
		\item Take $sk=(1, -\vec{s}$
		\item Take $C=\mu I_n+$
	



}

\frame{
	\frametitle{GSW's tools - terminology}
	\begin{itemize}[<+->]
		\item For the sake of illustration, fix $q=2^l=2^4$.
		\item Let $a=\underline{a_3a_2a_1a_0}=\sum 2^ia_i$ represent
			the base-2 digits of $a$
		\item Similarly, denote base-2 numbers like
			$\underline{1011}=8+2+1=11$
	\end{itemize}
}
	

\frame{
	\frametitle{GSW's tools - Powersof2}
	\begin{itemize}[<+->]
		\item $\textnormal{Powersof2}(a)=(2^3a, 2^2a, 2a, a)$
		\item $=\begin{pmatrix}2^3a\\2^2a\\2a\\a\end{pmatrix}$
		\item $\textnormal{Powersof2}(\underline{11})= (\underline{1000},
			\underline{1100}, \underline{110}, \underline{11})$
		\item $\textnormal{Powersof2}(a, b)
			=(2^3a, 2^2a, 2a, a, 2^3b, 2^2b, 2b, b)$
	\end{itemize}
}

\frame{
	\frametitle{GSW's tools - BitDecomp}
	\begin{itemize}[<+->]
		\item $\textnormal{BitDecomp}(\underline{a_3a_2a_1a_0})=
			\begin{pmatrix} a_3 & a_2 & a_1 & a_0 \end{pmatrix}$
		\item $\textnormal{BitDecomp}
			\begin{pmatrix}
				\underline{a_3a_2a_1a_0} & \underline{b_3b_2b_1b_0} \\
				\underline{c_3c_2c_1c_0} & \underline{d_3d_2d_1d_0}
			\end{pmatrix}
			= \begin{pmatrix}
				a_3 & a_2 & a_1 & a_0 & b_3 & b_2 & b_1 & b_0 \\
				c_3 & c_2 & c_1 & c_0 & d_3 & d_2 & d_1 & d_0
			\end{pmatrix}$
		\item $\textnormal{BitDecomp}(A)
			\textnormal{Powersof2}(\vec{b})
			=A\vec{b}$
	\end{itemize}
}

\frame{
	\frametitle{GSW's tools - $\textnormal{BitDecomp}^{-1}$}
	\begin{itemize}[<+->]
		\item $\textnormal{BitDecomp}^{-1}\begin{pmatrix}
			1 & 0 & 0 & 1
		\end{pmatrix} = \underline{1001}$
		\item $\textnormal{BitDecomp}^{-1}\begin{pmatrix}
			0 & 0 & \underline{10} & 0
		\end{pmatrix} = \underline{0100}$
		\item $A\textnormal{Powersof2}(\vec{b})
			=\textnormal{BitDecomp}^{-1}(A)\vec{b}$
	\end{itemize}
}

\frame{
	\frametitle{GSW's tools (Flatten)}
	\begin{itemize}[<+->]
		\item $\textnormal{Flatten}=\textnormal{BitDecomp}\circ
			\textnormal{BitDecomp}^{-1}$
		\item $\textnormal{Flatten}
			\begin{pmatrix}
				\underline{110} & \underline{101} & 1 & \underline{11}
			\end{pmatrix}$
		\item $=\textnormal{BitDecomp}\circ\textnormal{BitDecomp}^{-1}
			\begin{pmatrix}
				\underline{110} & \underline{101} & 1 & \underline{11}
			\end{pmatrix}$
		\item $=\begin{pmatrix}1&0&0&1\end{pmatrix}$
		\item $\textnormal{Flatten}(A)$ has only $0, 1$ entries
		\item $\textnormal{Flatten}(A)\textnormal{Powersof2}(\vec{b})
			=A\textnormal{Powersof2}(\vec{b})$
	\end{itemize}
}

\frame{
	\frametitle{GSW's Construction - Setup}
	Choose the following parameters:
	\begin{itemize}[<+->]
		\item Modulus $q=2^l$ (to simplify some proofs)
		\item Lattice dimension $n$
		\item Error distribution $\chi(\lambda, L)$
		\item $m\in O(n\log q)$
	\end{itemize}
}

\frame{
	\frametitle{GSW's Construction - Secret Keygen}
	\begin{enumerate}[<+->]
		\item Sample $\vec{s}\leftarrow\mathbb{Z}^n_q$ uniformly.
			This represents the solution of the LWE system of equations.
		\item Output $sk$ as $1$ on the first coordinate,
			followed by $-\vec{s}$.
	\end{enumerate}
}

\frame{
	\frametitle{GSW's Construction - Public Keygen}
	\begin{enumerate}[<+->]
		\item Generate $B\leftarrow\mathbb{Z}^{m\times n}_q$ uniformly
		\item Sample $\vec{e}\leftarrow\chi^m$
		\item Set $pk$ as $B\vec{s}+\vec{e}$ on the first column,
			followed by the columns of $B$.
		\item Observe that $pk\cdot sk=\vec{e}$
	\end{enumerate}
}

\frame{
	\frametitle{GSW's Construction - Encryption}
	Input: $\mu$
	\begin{enumerate}[<+->]
		\item Sample $R\in\{0, 1\}^{N\times m}$
		\item Output $\textnormal{Flatten}(
			\mu\cdot I+\textnormal{BitDecomp}(R\cdot pk))$
	\end{enumerate}
}

\frame{
	\frametitle{GSW's Construction - Decryption}
	$\textnormal{Flatten}(
			\mu\cdot I+\textnormal{BitDecomp}(R\cdot pk))
			\cdot\textnormal{Powersof2}(sk)$
	\pause
	$=(\mu\cdot I+\textnormal{BitDecomp}(R\cdot pk))
			\cdot\textnormal{Powersof2}(sk)$
	\pause
	$=\mu\textnormal{Powersof2}(sk) + R\cdot pk\cdot sk$
}

\frame{
	\frametitle{GSW's Construction - Decryption cont.}
	$\mu\textnormal{Powersof2}(sk) + R\cdot pk\cdot sk$
	\begin{itemize}[<+->]
		\item The second term is small.
		\item The first coordinate of $sk$ is $1$.
		\item $\Rightarrow$ The first coordinates of 
			$\mu\textnormal{Powersof2}(sk) + R\cdot pk\cdot sk$
			are $\approx2^{l-1}\mu, 2^{l-2}\mu, \ldots, \mu$
		\item Recover $\mu$'s least significant bit by $LSB(\mu)=2^{l-1}\mu$
		\item Recover $\mu$'s next bit by $2^{l-2}(\mu-LSB(\mu))$
		\item Similar for all other bits of $\mu$.
		\item Decryption breaks down when the error reaches $q/4$.
	\end{itemize}
}

\frame{
	\frametitle{GSW's Construction - Security}
	\begin{itemize}[<+->]
		\item If $C=\textnormal{Enc}_{pk}(\mu, r)$ hides $\mu$, so does
			$\textnormal{BitDecomp}^{-1}(C)$, since $C$ can be derived from
			it.
		\item $\textnormal{BitDecomp}^{-1}(C)
			=\mu\cdot\textnormal{BitDecomp}^{-1}(I)+R\cdot A$
		\item Fact: The joint distribution $(A, R\cdot A)$ is
			indistinguishable from uniform, if $m>2nl$
	\end{itemize}
}

\frame{
	\frametitle{Security}
	\begin{itemize}[<+->]
		\item What does it mean for an encryption scheme to be secure?
		\item Chosen plaintext attack (CPA): The "intuitive" definition.
			An (efficient) adversary who's able to encrypt anything shouldn't
			be able to decrypt anything.
		\item Ciphertext indistinguishability
	\end{itemize}
}

\frame{
	\frametitle{GSW's Construction - NAND}
	\begin{itemize}[<+->]
		\item $(I-C_1\cdot C_2)\vec{v}
			=(1-\mu_1\mu_2)\vec{v}-\mu_2\vec{e}_1-C_1\vec{e}_2$
		\item Error increased by a factor of $N+1$.
		\item Final error increase by a factor of $(N+1)^L$
	\end{itemize}
}

\frame{
	\frametitle{GSW's Construction - Multiplying by constant}
	Input: $C, \alpha$
	\begin{itemize}[<+->]
		\item Set $M_\alpha=\textnormal{Flatten}(\alpha I)$	
		\item Output $\textnormal{Flatten}(M_\alpha\cdot C)$
		\item Observe $M_\alpha\cdot C\vec{v}
			=M_\alpha\cdot(\mu\vec{v}+\vec{e})
			=\alpha\mu\vec{v}+M_\alpha\cdot{e}$
		\item Error increases by a factor of $N$
	\end{itemize}
}

\frame{
	\frametitle{GSW's Construction - Addition}
	\begin{itemize}[<+->]
		\item Simply add the ciphertexts
		\item Error increases by a factor of 2
	\end{itemize}
}

\frame{
	\frametitle{GSW's Construction - Multiplication}
	\begin{itemize}[<+->]
		\item $C_1\cdot C_2\vec{v}=C_1(\mu_2\vec{v}+\vec{e}_2)
			=\mu_1\mu_2\vec{v}+\mu_2\vec{e}_1+C_1\vec{e}_2$
		\item Error increase depends on what's being encrypted
		\item May need to assume bounds on the values being computed
	\end{itemize}
}

\frame{
	\frametitle{References}
	\begin{itemize}
		\item O. Regev. The Learning with Errors Problem.
		\item C. Gentry, A. Sahai, B. Waters.
			Homomorphic Encryption from Learning with Errors:
			Conceptually-Simpler, Asymptotically-Faster, Attribute-Based.
	\end{itemize}
}

\end{document}
